var T=Object.defineProperty;var A=(n,t,e)=>t in n?T(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var E=(n,t,e)=>(A(n,typeof t!="symbol"?t+"":t,e),e),x=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var l=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)};var c=(n,t,e)=>(x(n,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var p,M,y,v,C,w,L,b,m,S,q,k;class P{constructor(){l(this,p);l(this,y);l(this,C);l(this,L);l(this,m);l(this,q);this.container=document.querySelector(".loader"),this.paths=document.querySelectorAll(".car-svg path"),this.maxLength=0,this.keyframe=[],this.timing={duration:3e3,iterations:1/0,direction:"alternate"},this.animations=[]}render(){c(this,q,k).call(this),this.container.style.display="grid"}hide(){this.container.style.display="none",c(this,m,S).call(this)}init(){var t,e,r;c(r=c(e=c(t=c(this,p,M).call(this),y,v).call(t),C,w).call(e),L,b).call(r).render()}}p=new WeakSet,M=function(){const t=Array.from(this.paths).map(e=>e.getTotalLength());return this.maxLength=Math.floor(Math.max(...t)),this},y=new WeakSet,v=function(){return this.paths.forEach(t=>{const e=t;e.style.stroke="var(--secondary-color)",e.style.strokeDasharray=Math.floor(this.maxLength/2),e.style.strokeDashoffset=0}),this},C=new WeakSet,w=function(){return this.keyframe=[{strokeDashoffset:this.maxLength},{strokeDashoffset:0}],this},L=new WeakSet,b=function(){return this.animations=Array.from(this.paths).map(t=>t.animate(this.keyframe,this.timing)),c(this,m,S).call(this),this},m=new WeakSet,S=function(){this.animations.forEach(t=>t.pause())},q=new WeakSet,k=function(){this.animations.forEach(t=>t.play())};const D=(n,t)=>{let e;return(...r)=>{clearTimeout(e),e=setTimeout(()=>{n(...r)},t)}},h=n=>n.replace(/\s/g,"").toLowerCase();class O{constructor(){E(this,"renderSuggestions",D((t,e)=>{if(e.target.value==="")return;t(e.target.value).forEach(s=>{this.createSuggestionCard(s)})},150));this.input=document.querySelector("#guess-input"),this.suggestionContainer=document.querySelector(".suggestions"),this.guessContainer=document.querySelector(".guesses"),this.restartBtn=document.querySelector(".fa-rotate"),this.infoContainer=document.querySelector(".info-settings"),this.instructionsBtn=document.querySelector(".fa-gear"),this.unitSelect=document.querySelector("#units"),this.unitOptions=document.querySelectorAll("#units option")}reset(){this.clearGuesses(),this.enableInput(),this.resetSuggestionContainer(),this.restartBtn.style.display="none"}resetInput(){this.input.value=""}disableInput(){this.input.disabled=!0}enableInput(){this.input.disabled=!1}resetSuggestionContainer(){this.suggestionContainer.innerHTML=""}clearGuesses(){this.guessContainer.innerHTML=""}renderRestartBtn(){this.restartBtn.style.display="block"}inputShake(){this.input.classList.remove("input-shake"),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.input.classList.add("input-shake")})})}static Suggestion(t){const e=document.createElement("button");return e.classList.add("suggestion"),(t==null?void 0:t.type)==="error"?(e.classList.add("suggestion-error"),e.tabIndex="-1"):(t==null?void 0:t.type)==="suggestion"&&(e.dataset.type="suggestion"),e}static GuessCard(){const t=document.createElement("div");t.classList.add("guess");const e=document.createElement("p");return e.classList.add("name"),t.appendChild(e),t}createSuggestionCard(t){const e=this.constructor.Suggestion({type:"suggestion"});e.textContent=t.manufacturer,this.suggestionContainer.appendChild(e)}renderInvalidGuessSuggestion(){const t=this.constructor.Suggestion({type:"error"});t.textContent="not a manufacturer",this.suggestionContainer.appendChild(t)}renderAlreadyGuessedSuggestion(){const t=this.constructor.Suggestion({type:"error"});t.textContent="already guessed",this.suggestionContainer.appendChild(t)}renderLossSuggestion(){const t=this.constructor.Suggestion({type:"error"});t.textContent="out of guesses",this.suggestionContainer.appendChild(t)}renderWinCard(t){const e=this.constructor.GuessCard();e.classList.add("guess-correct"),e.firstElementChild.textContent=`${t} is correct!`,this.guessContainer.insertAdjacentElement("afterbegin",e)}renderLossCard(t){const e=this.constructor.GuessCard();e.classList.add("guess-loss"),e.firstElementChild.textContent=`${t.manufacturer} was correct!`,this.guessContainer.insertAdjacentElement("afterbegin",e)}renderValidGuessCard(t,e,r){const s=this.constructor.GuessCard();s.firstElementChild.textContent=t;const a=document.createElement("div");a.classList.add("indicators");const d=document.createElement("p");d.classList.add("distance"),d.textContent=e;const o=document.createElement("p");o.classList.add("arrow","direction"),o.innerHTML="&rarr;",o.style.transform=`rotate(-${r}deg)`,a.appendChild(d),a.appendChild(o),s.appendChild(a),this.guessContainer.insertAdjacentElement("afterbegin",s)}toggleInfoSettingsPanel(){this.infoContainer.classList.toggle("info-settings-hidden"),this.infoContainer.classList.toggle("info-settings-shown")}updateExistingDistances(t){const e=this.guessContainer.children;if(e.length>0)for(let r=0;r<e.length;r+=1){const s=e[r].children[1].children[0],a=s.textContent.split(" ")[0];s.textContent=t(a)}}displayInvalid(){this.renderInvalidGuessSuggestion(),this.inputShake()}displayAlreadyGuessed(){this.renderAlreadyGuessedSuggestion(),this.inputShake()}displayLoss(t){this.renderLossCard(t),this.renderLossSuggestion(),this.disableInput(),this.renderRestartBtn()}displayWin(t){this.renderWinCard(t),this.disableInput(),this.renderRestartBtn()}bindOnInputChange(t){this.input.addEventListener("input",e=>{this.resetSuggestionContainer(),this.renderSuggestions(t,e)})}bindSuggestionEvent(t){document.addEventListener("click",e=>{e.target.dataset.type==="suggestion"&&(this.resetSuggestionContainer(),t(e.target.textContent))}),document.addEventListener("keydown",e=>{e.key==="Enter"&&e.target.dataset.type==="suggestion"&&(this.resetSuggestionContainer(),t(e.target.textContent))})}bindGuessInput(t){this.input.addEventListener("keydown",e=>{if(e.key==="Enter"){if(e.target.value==="")return;this.resetSuggestionContainer(),t(e.target.value),this.resetInput(e)}})}bindRestartGame(t){this.restartBtn.addEventListener("click",()=>{t()}),this.restartBtn.addEventListener("keydown",e=>{e.key==="Enter"&&t()})}bindToggleInstructions(){this.instructionsBtn.addEventListener("click",()=>{this.toggleInfoSettingsPanel()})}bindChangeUnits(t){this.unitSelect.addEventListener("change",e=>{t(e.target.value)})}}const R=[{id:1,manufacturer:"Acura",hq:"Tokyo, JP"},{id:2,manufacturer:"Alfa Romeo",hq:"Turin, IT"},{id:3,manufacturer:"Audi",hq:"Ingolstadt, DE"},{id:4,manufacturer:"BMW",hq:"Munich, DE"},{id:5,manufacturer:"Buick",hq:"Detroit, Michigan"},{id:6,manufacturer:"Cadillac",hq:"Warren, Michigan"},{id:7,manufacturer:"Chevrolet",hq:"Detroit, Michigan"},{id:8,manufacturer:"Chrysler",hq:"Auburn Hills, Michigan"},{id:9,manufacturer:"Dodge",hq:"Auburn Hills, Michigan"},{id:10,manufacturer:"Ford",hq:"Dearborn, Michigan"},{id:11,manufacturer:"Genesis",hq:"Fountain Valley, California"},{id:12,manufacturer:"GMC",hq:"Detroit, Michigan"},{id:13,manufacturer:"Honda",hq:"Tokyo, JP"},{id:14,manufacturer:"Hyundai",hq:"Seoul, KR"},{id:15,manufacturer:"Infiniti",hq:"Yokohama, JP"},{id:16,manufacturer:"Jaguar",hq:"Coventry, England"},{id:17,manufacturer:"Jeep",hq:"Toledo, Ohio"},{id:18,manufacturer:"Kia",hq:"Seoul, KR"},{id:19,manufacturer:"Land Rover",hq:"Coventry, England"},{id:20,manufacturer:"Lexus",hq:"Nagoya, JP"},{id:21,manufacturer:"Lincoln",hq:"Radnor, Pennsylvania"},{id:22,manufacturer:"Maserati",hq:"Modena, IT"},{id:23,manufacturer:"Mazda",hq:"Fuchu, JP"},{id:24,manufacturer:"Mercedes Benz",hq:"Stuttgart, DE"},{id:25,manufacturer:"MINI",hq:"Oxford, England"},{id:26,manufacturer:"Mitsubishi",hq:"Tokyo, JP"},{id:27,manufacturer:"Nissan",hq:"Yokohama, JP"},{id:28,manufacturer:"Pontiac",hq:"Detroit, Michigan"},{id:29,manufacturer:"Porsche",hq:"Stuttgart, DE"},{id:30,manufacturer:"RAM",hq:"Auburn Hills, Michigan"},{id:31,manufacturer:"Subaru",hq:"Tokyo, JP"},{id:32,manufacturer:"Tesla",hq:"Austin, Texas"},{id:33,manufacturer:"Toyota",hq:"Toyota, JP"},{id:34,manufacturer:"Volkwagen",hq:"Wolfsburg, DE"},{id:35,manufacturer:"Volvo",hq:"Gothenburg, SE"}];class B{constructor(){this.list=R,this.answer=this.list[this.randomIndex()]}randomIndex(){return Math.floor(Math.random()*this.list.length)}setAnswer(){this.answer=this.list[this.randomIndex()]}}class J extends B{constructor(){super(),this.last="",this.history=[],this.count=0}getCount(){return this.count}reset(){this.count=0,this.history.length=0,this.setAnswer()}getMatchingManufacturers(t){return this.list.filter((r,s)=>h(this.list[s].manufacturer).includes(h(t)))}inList(){return this.list.find(t=>h(t.manufacturer)===h(this.last))}addGuessToHistory(t){this.history.unshift(h(t))}previouslySubmitted(t){return this.history.some(e=>e===h(t))}matchesAnswer(){return h(this.last)===h(this.answer.manufacturer)}checkLoss(){return this.count===5&&!this.matchesAnswer()}increaseCount(){this.count+=1}}const $="b822c6c2a2f2f749e1c7b6aa16ea6f97";class F{constructor(){this.locations=[],this.key=$,this.endpoint="https://api.openweathermap.org/geo/1.0/direct?",this.coordinates={guess:{},answer:{}},this.units="mi"}setUnits(t){this.units!==t&&(this.units=t)}reset(){Object.keys(this.coordinates).forEach(t=>{this.coordinates[t]={}})}convertDistance(t){return this.units==="km"?`${Math.round(t*1.60934)} km`:`${Math.round(t*.621371)} mi`}static convertToRadians(t){return t*(Math.PI/180)}static convertToDegrees(t){return t*(180/Math.PI)}getLocation(t){return fetch(`${this.endpoint}q=${t}&limit=5&appid=${this.key}`)}async getCoordinates(t,e){try{const r=await Promise.all([this.getLocation(t),this.getLocation(e)]),d=(await Promise.all(r.map(o=>o.json()))).map(o=>{const u=[t.split(",")[0].replace(/\W/g," "),t.split(",")[1].trim()],g=[e.split(",")[0].replace(/\W/g," "),e.split(",")[1].trim()];return o.find(i=>i.name===u[0]&&(i==null?void 0:i.state)===u[1]||i.name===u[0]&&(i==null?void 0:i.country)===u[1]||i.name===g[0]&&(i==null?void 0:i.state)===g[1]||i.name===g[0]&&(i==null?void 0:i.country)===g[1]?i:!1)}).map(o=>({lat:o==null?void 0:o.lat,lon:o==null?void 0:o.lon}));[this.coordinates.guess,this.coordinates.answer]=d}catch(r){throw new Error(r)}}degreeToRadians(){const t=structuredClone(this.coordinates);return Object.keys(t).forEach(e=>{t[e].lat=this.constructor.convertToRadians(t[e].lat),t[e].lon=this.constructor.convertToRadians(t[e].lon)}),t}distanceBetweenGuessAnswer(){const t=this.degreeToRadians(),e=t.answer.lat-t.guess.lat,r=t.answer.lon-t.guess.lon,s=Math.sin(e/2)**2+Math.cos(t.guess.lat)*Math.cos(t.answer.lat)*Math.sin(r/2)**2,a=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),d=this.units==="mi"?3956:6371;return`${Math.round(a*d)} ${this.units}`}angleFromGuessToAnswer(){const t=this.degreeToRadians(),e=t.answer.lat-t.guess.lat,r=t.answer.lon-t.guess.lon;let s=Math.atan2(e,r);return s=this.constructor.convertToDegrees(s),s=(s+360)%360,s}}const f={loader:new P},W=()=>{const n=new J,t=new F,e=new O,r=u=>n.getMatchingManufacturers(u),s=async u=>{n.last=u;const g=async()=>{f.loader.render();const i=n.inList();n.addGuessToHistory(i.manufacturer),await t.getCoordinates(i.hq,n.answer.hq);const I=t.distanceBetweenGuessAnswer(),G=t.angleFromGuessToAnswer();n.increaseCount(),f.loader.hide(),e.renderValidGuessCard(i.manufacturer,I,G),n.checkLoss()&&setTimeout(()=>e.displayLoss(n.answer),750)};if(!n.inList()){e.displayInvalid();return}if(n.previouslySubmitted(u)){e.displayAlreadyGuessed();return}if(n.matchesAnswer(u)){e.displayWin(u);return}g()},a=u=>{e.input.value="",e.input.focus(),s(u)},d=()=>{n.reset(),t.reset(),e.reset()},o=u=>{t.setUnits(u),e.updateExistingDistances(t.convertDistance.bind(t))};e.bindOnInputChange(r),e.bindSuggestionEvent(a),e.bindGuessInput(s),e.bindRestartGame(d),e.bindToggleInstructions(),e.bindChangeUnits(o)};document.addEventListener("DOMContentLoaded",async()=>{f.loader.init(),await new Promise(n=>{setTimeout(()=>{f.loader.hide(),n()},1e3)}),W()});
